(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{229:function(t,e,a){"use strict";a.r(e);var i=a(3),o=a(1);i.d.add(o.v,o.hb,o.G);var r={components:{RoomsTable:function(){return a.e(48).then(a.bind(null,337))}},props:["user"],data:function(){return{crms:Array,roomsData:{total:0,per_page:2,from:1,to:0,current_page:1},searchText:"",currentCrm:0}},watch:{currentCrm:function(t){this.getRoomsData()}},mounted:function(){this.getCrms(),this.getRoomsData()},methods:{getCrms:function(){var t=this;axios.get("/api/crms").then((function(e){t.crms=e.data.crms}))},orderedRooms:function(t){return _.orderBy(t.rooms,"order")},getRoomsData:function(){var t=this,e={page:this.roomsData.current_page,crm_id:this.currentCrm,text:""!=this.searchText?this.searchText:0};axios.get("/api/rooms",{params:e}).then((function(e){t.roomsData=e.data}))},clearSearch:function(){this.searchText="",this.getRoomsData()}}},s=a(0),n=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section has-background-dark"},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},t._l(t.crms,(function(e){return a("div",{key:e.id,staticClass:"column tile is-parent",on:{click:function(a){t.currentCrm=t.currentCrm===e.id?0:e.id}}},[a("div",{staticClass:"tile is-child box has-text-centered has-text-white",class:t.currentCrm===e.id?"is-bold is-link":"has-background-black-ter"},[a("div",{staticClass:"is-size-4 has-text-weight-semibold",domProps:{textContent:t._s(e.sigla_crm)}}),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("div",{staticClass:"is-size-7 has-text-weight-normal"},[t._v("\n                            "+t._s(e.nombre_crm)+"\n                        ")])])])])})),0),t._v(" "),a("div",{staticClass:"box has-background-black-ter"},[a("div",{staticClass:"field"},[a("div",{staticClass:"control has-icons-left has-icons-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"input is-rounded has-background-black-ter has-text-light",attrs:{type:"text","arial-label":"Buscar",placeholder:"Buscar...",autofocus:""},domProps:{value:t.searchText},on:{keyup:t.getRoomsData,input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t._v(" "),a("span",{staticClass:"icon is-small is-left"},[a("font-awesome-icon",{attrs:{icon:"search"}})],1),t._v(" "),a("span",{staticClass:"icon is-small is-right"},[a("button",{staticClass:"delete",on:{click:t.clearSearch}})])])]),t._v(" "),a("RoomsTable",{attrs:{roomsData:t.roomsData,user:t.user}})],1)])])}),[],!1,null,null,null);e.default=n.exports},230:function(t,e,a){"use strict";a.r(e);var i=a(3),o=a(1),r=a(19),s=a(4);i.d.add(o.W,o.yb,o.q,o.N,o.g,o.l,s.d,o.fb,o.C,o.db,o.r,o.E,o.D,o.lb,o.qb,r.a,o.gb,o.h,o.ob,o.kb,o.o,o.Q,o.Z,s.e,o.G,o.wb);var n={components:{Capacity:function(){return a.e(29).then(a.bind(null,338))},Projection:function(){return a.e(46).then(a.bind(null,339))},Distribution:function(){return a.e(32).then(a.bind(null,340))},Layout:function(){return a.e(34).then(a.bind(null,341))},Documents:function(){return a.e(114).then(a.bind(null,335))},ModalNewRoom:function(){return a.e(42).then(a.bind(null,342))}},props:["user"],data:function(){return{room:"",currentTab:"capacity",tabs:[{title:"Capacity",component:"capacity",icon:"traffic-light",icon_type:"fas"},{title:"Distribución",component:"distribution",icon:"bezier-curve",icon_type:"fas"},{title:"Layout",component:"layout",icon:"map",icon_type:"far"},{title:"Documentos",component:"documents",icon:"folder-open",icon_type:"far"}],junctions:Object,generatorSets:Object,planes:Object,planeTypes:Object,airConditioners:Object,canEditJunctions:!1,canEditGeneratorSets:!1,canEditPowerRectifiers:!1,canEditAirConditioners:!1,canEditPlaneTypes:!1,isNewRoomModalActive:!1,planeTypeId:0,record:!1}},created:function(){this.$eventBus.$on("room-data",this.getRoomData),this.$eventBus.$on("room-distribution",this.getRoomData),this.$eventBus.$on("room-surface",this.getRoomData),this.$eventBus.$on("room-security",this.getRoomData),this.$eventBus.$on("change-room",this.getRoomData),this.$eventBus.$on("new-power-rectifier",this.getRoomData),this.$eventBus.$on("new-junction",this.getRoomData),this.$eventBus.$on("power-rectifier-updated",this.getRoomData),this.$eventBus.$on("new-plane-updated",this.getRoomData),this.$eventBus.$on("new-battery-bank",this.getRoomData),this.$eventBus.$on("new-generator-set",this.getRoomData),this.$eventBus.$on("new-room",this.getRoomData),this.$eventBus.$on("new-solar-panel",this.getRoomData),this.$eventBus.$on("junction-measurements-updated",this.getRoomData),this.$eventBus.$on("generator-set-capacities-updated",this.getRoomData),this.$eventBus.$on("reload-data",this.getRoomData),this.$eventBus.$on("battery-bank-deleted",this.getRoomData),this.$eventBus.$on("generator-set-deleted",this.getRoomData)},mounted:function(){this.getRoomData()},watch:{totalCapacityBatteries:function(){this.record?this.recordCapacities():this.record=!0},planeTypeId:function(t){},isEditMode:function(t){0==t&&this.getPlanes()}},computed:{canEditSurface:function(){return this.canEditPowerRectifiers||this.canEditJunctions||this.canEditAirConditioners},canEditDistribution:function(){return this.canEditPowerRectifiers||this.canEditJunctions||this.canEditAirConditioners},capacityData:function(){return[{title:"Empalme",total:this.totalJunctionsCapacity,used:this.totalUsedJunctionsCapacity,available:this.totalAvailableJunctionsCapacity,isLoading:!(!this.junctions.length||0!=this.totalJunctionsCapacity),thresholds:this.thresholds.junctions,unit:"kW"},{title:"Grupo Electrógeno",total:this.totalGeneratorSetsCapacity,used:this.totalGeneratorSetsUsedCapacity,available:this.totalAvailableGeneratorSetsCapacity,isLoading:!this.totalGeneratorSetsCapacity&&0!=!this.generatorSets.length,thresholds:this.thresholds.generatorSets,unit:"kW"},{title:"Plantas Rectificadoras",total:this.totalCapacityRoom,used:this.usedCapacityRoom,available:this.availableCapacityRoom(this.room),isLoading:!(this.totalCapacityRoom||!this.powerRectifiersInRoom(this.room)),thresholds:this.thresholds.powerRectifiers,unit:"kW"},{title:"Baterías",total:this.totalCapacityBatteries(this.room),used:this.usedCapacityBatteries(this.room),available:this.availableCapacityBatteries(this.room),isLoading:!(this.totalCapacityBatteries(this.room)||!this.batteryBanksInRoom(this.room)),thresholds:this.thresholds.batteries,unit:"kW"},{title:"Clima",total:this.totalClimateCapacity,used:this.usedClimateCapacity,available:this.totalAvailableClimateCapacity,isLoading:!(!this.totalClimateCapacity||this.usedClimateCapacity),thresholds:this.thresholds.climate,unit:"kW"},{title:"Distribución",total:this.totalDistributionCapacity,used:this.usedDistributionCapacity,available:this.availableDistributionCapacity,isLoading:!(!this.totalDistributionCapacity||this.usedDistributionCapacity),thresholds:this.thresholds.disponibility,unit:"kW"},{title:"Espacio",total:this.totalSurface,used:this.usedSurface,available:this.availableSurface,isLoading:!(!this.totalSurface||this.usedSurface),thresholds:this.thresholds.surface,unit:"un"}]},pop:function(){return this.room.pop},currentTabComponent:function(){return this.currentTab},responsable:function(){return{id:null,area:"Sin Información"}},totalJunctionsCapacity:function(){var t=this,e=0;return this.junctions.length&&Object.keys(this.junctions).forEach((function(a){(!t.junctions[a].room_id||t.junctions[a].room_id&&t.junctions[a].room_id==t.room.id)&&(e=e+(t.powerA(t.junctions[a])+t.powerB(t.junctions[a]))*t.junctions[a].use_factor+t.photovoltaicCapacity(t.junctions[a]))})),e},totalUsedJunctionsCapacity:function(){var t=this,e=0,a=0,i=0;return this.junctions.length&&Object.keys(this.junctions).forEach((function(o){(!t.junctions[o].room_id||t.junctions[o].room_id&&t.junctions[o].room_id==t.room.id)&&(t.junctions[o].latest_measurement&&(i+=t.junctions[o].latest_measurement.punctual_consumption),e||(e=t.junctions[o].room_id&&t.junctions[o].room_id==t.room.id?1:0)),a=e?0:t.batteriesRecharge})),this.withoutBatteriesCapacity+a+i},withoutBatteriesCapacity:function(){var t=this,e=0;return this.junctions.length&&Object.keys(this.junctions).forEach((function(a){(!t.junctions[a].room_id||t.junctions[a].room_id&&t.junctions[a].room_id==t.room.id)&&(e=e+t.powerUsedA(t.junctions[a])+t.powerUsedB(t.junctions[a])+t.averageConsumptionPerPhotovoltaicGroup)})),e},batteriesRecharge:function(){var t=this,e=0;return this.pop&&Object.keys(this.pop.rooms).forEach((function(a){var i=t.pop.rooms[a];i.power_rectifiers.length&&Object.keys(i.planes).forEach((function(a){var o=i.planes[a];e+=t.batteryRechargePower(o)}))})),e},averageConsumptionPerPhotovoltaicGroup:function(){return 0},totalAvailableJunctionsCapacity:function(){return this.totalJunctionsCapacity-this.totalUsedJunctionsCapacity},totalGeneratorSetsCapacity:function(){var t=this,e=0;return 1==this.generatorSetsResponsable.id?e=this.totalGeneratorSetsCapacityA+this.totalGeneratorSetsCapacityB:Object.keys(this.generatorSets).forEach((function(a){e=t.generatorSets[a].current_generator_set_corp_disponibility&&0==e?t.generatorSets[0].current_generator_set_corp_disponibility.total_capacity:e})),e},totalGeneratorSetsCapacityA:function(){var t=this,e=0,a=0,i=1;return this.generatorSets.length&&Object.keys(this.generatorSets).forEach((function(o){if(!t.generatorSets[o].room_id||t.generatorSets[o].room_id&&t.generatorSets[o].room_id==t.room.id){var r=.8*(t.generatorSets[o].current_generator_set_capacity?t.generatorSets[o].current_generator_set_capacity.prime_capacity:0);switch(t.generatorSets[o].generator_set_topology_type_id){case 1:e+=r;break;case 2:e+=r,a+=r,i=i++;break;case 3:e=2==t.generatorSets[o].generator_set_level_type_id?e+r:e}}})),e-a/i},totalGeneratorSetsCapacityB:function(){var t=this,e=0;return this.generatorSets.length&&Object.keys(this.generatorSets).forEach((function(a){if(!t.generatorSets[a].room_id||t.generatorSets[a].room_id&&t.generatorSets[a].room_id==t.room.id){var i=.8*(t.generatorSets[a].current_generator_set_capacity?t.generatorSets[a].current_generator_set_capacity.prime_capacity:0);switch(t.generatorSets[a].generator_set_topology_type_id){case 1:case 2:default:break;case 3:e=3==t.generatorSets[a].generator_set_level_type_id?e+i:e}}})),e},generatorSetsResponsable:function(){var t=this,e="Sin Información",a=null;return this.generatorSets.length&&Object.keys(this.generatorSets).forEach((function(i){if(t.generatorSets[i].current_generator_responsable)switch(t.generatorSets[i].current_generator_responsable.generator_set_responsable_area_id){case 1:a=1,e=t.generatorSets[i].current_generator_responsable.generator_set_responsable_area.area;break;case 2:a=1==a?a:2,arae=1==a?e:t.generatorSets[i].current_generator_responsable.generator_set_responsable_area.area;break;case 3:e=1==(a=1==a||2==a?a:3)||2==a?e:t.generatorSets[i].current_generator_responsable.generator_set_responsable_area.area}})),{id:a,area:e}},totalGeneratorSetsUsedCapacity:function(){var t=this,e=0;return 1==this.generatorSetsResponsable.id?e=this.usedGeneratorSetsCapacityA+this.usedGeneratorSetsCapacityB:Object.keys(this.generatorSets).forEach((function(a){e=t.generatorSets[a].current_generator_set_corp_disponibility&&0==e?t.generatorSets[0].current_generator_set_corp_disponibility.used_capacity:e})),e},usedGeneratorSetsCapacityA:function(){var t=this,e=0;return this.generatorSets.length&&Object.keys(this.generatorSets).forEach((function(a){if(!t.generatorSets[a].room_id||t.generatorSets[a].room_id&&t.generatorSets[a].room_id==t.room.id){var i=t.generatorSets[a].current_generator_set_capacity?t.generatorSets[a].current_generator_set_capacity.used_capacity:0;switch(t.generatorSets[a].generator_set_topology_type_id){case 1:case 2:e+=i;break;case 3:e=2==t.generatorSets[a].generator_set_level_type_id?e+i:e}}})),e},usedGeneratorSetsCapacityB:function(){var t=this,e=0;return this.generatorSets.length&&Object.keys(this.generatorSets).forEach((function(a){if(!t.generatorSets[a].room_id||t.generatorSets[a].room_id&&t.generatorSets[a].room_id==t.room.id){var i=t.generatorSets[a].current_generator_set_capacity?t.generatorSets[a].current_generator_set_capacity.used_capacity:0;switch(t.generatorSets[a].generator_set_topology_type_id){case 1:case 2:default:break;case 3:e=3==t.generatorSets[a].generator_set_level_type_id?e+i:e}}})),e},totalAvailableGeneratorSetsCapacity:function(){var t=this,e=0;return 1==this.generatorSetsResponsable.id?e=this.availableGeneratorSetsCapacityA+this.availableGeneratorSetsCapacityB:Object.keys(this.generatorSets).forEach((function(a){e=t.generatorSets[a].current_generator_set_corp_disponibility&&0==e?t.generatorSets[0].current_generator_set_corp_disponibility.available_capacity:e})),e},availableGeneratorSetsCapacityA:function(){return this.totalGeneratorSetsCapacityA-this.usedGeneratorSetsCapacityA},availableGeneratorSetsCapacityB:function(){return this.totalGeneratorSetsCapacityB-this.usedGeneratorSetsCapacityB},totalCapacityRoom:function(){var t=this,e=0;return Object.keys(this.planes).forEach((function(a){var i=t.planes[a];e+=t.realPlaneCapacity(i)})),e},usedCapacityRoom:function(){var t=this,e=0;return Object.keys(this.planes).forEach((function(a){var i=t.planes[a];e+=t.totalPower(i)})),e},popAutonomy:function(){return this.pop&&this.pop.current_battery_bank_autonomy?this.pop.current_battery_bank_autonomy.theoretical:0},totalClimateCapacity:function(){return this.room.current_air_conditioner_capacity?this.room.current_air_conditioner_capacity.total_capacity:0},usedClimateCapacity:function(){return this.room.current_air_conditioner_capacity?this.room.current_air_conditioner_capacity.used_capacity:0},totalAvailableClimateCapacity:function(){return this.totalClimateCapacity-this.usedClimateCapacity},totalDistributionCapacity:function(){return this.room.current_room_distribution?this.room.current_room_distribution.total_capacity:0},usedDistributionCapacity:function(){return this.room.current_room_distribution?this.room.current_room_distribution.used_capacity:0},availableDistributionCapacity:function(){return this.totalDistributionCapacity-this.usedDistributionCapacity},totalSurface:function(){return this.room.current_room_surface?this.room.current_room_surface.total_surface:0},usedSurface:function(){return this.room.current_room_surface?this.room.current_room_surface.used_surface:0},availableSurface:function(){return this.totalSurface-this.usedSurface},planeType:function(){var t=this,e="Sin Información";switch(this.planeTypeId){case 1:Object.keys(this.planeTypes).forEach((function(a){e=1==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 2:Object.keys(this.planeTypes).forEach((function(a){e=2==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 3:Object.keys(this.planeTypes).forEach((function(a){e=3==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 4:Object.keys(this.planeTypes).forEach((function(a){e=4==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 5:Object.keys(this.planeTypes).forEach((function(a){e=5==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 6:Object.keys(this.planeTypes).forEach((function(a){e=6==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 7:Object.keys(this.planeTypes).forEach((function(a){e=7==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 8:Object.keys(this.planeTypes).forEach((function(a){e=8==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 9:Object.keys(this.planeTypes).forEach((function(a){e=9==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}));break;case 10:Object.keys(this.planeTypes).forEach((function(a){e=10==t.planeTypes[a].id&&"Sin Información"==e?t.planeTypes[a].type:e}))}return e},thresholds:function(){return{junctions:{critical:.1,warning:.2},generatorSets:{critical:.1,warning:.2},powerRectifiers:{critical:.1,warning:.2},batteries:{critical:.1,warning:.2},climate:{critical:.1,warning:.2},disponibility:{critical:.1,warning:.2},surface:{critical:.1,warning:.2}}},popRooms:function(){var t=this,e=[];return this.pop&&Object.keys(this.pop.rooms).forEach((function(a){e.push(t.pop.rooms[a].id),e.sort((function(t,e){return t>e?1:t<e?-1:0}))})),e},previewRoom:function(){var t=0,e="";if(this.popRooms){var a=this.popRooms.indexOf(this.room.id);a-1>=0&&(t=this.popRooms[a-1],e=this.roomName(t))}return{id:t,name:e}},nextRoom:function(){var t=0,e="";if(this.popRooms){var a=this.popRooms.indexOf(this.room.id);a+1<=this.popRooms.length-1&&(t=this.popRooms[a+1],e=this.roomName(t))}return{id:t,name:e}},conditionsToRecord:function(){var t=function(t,e){return t+e},e=[];this.room.current_room_capacity&&(e=[Math.round(this.room.current_room_capacity.battery_autonomy,3),Math.round(this.room.current_room_capacity.junction_total,3),Math.round(this.room.current_room_capacity.junction_used,3),Math.round(this.room.current_room_capacity.junction_available,3),Math.round(this.room.current_room_capacity.generator_set_total,3),Math.round(this.room.current_room_capacity.generator_set_used,3),Math.round(this.room.current_room_capacity.generator_set_available,3),Math.round(this.room.current_room_capacity.power_rectifier_total,3),Math.round(this.room.current_room_capacity.power_rectifier_used,3),Math.round(this.room.current_room_capacity.power_rectifier_available,3),Math.round(this.room.current_room_capacity.battery_total,3),Math.round(this.room.current_room_capacity.battery_used,3),Math.round(this.room.current_room_capacity.battery_available,3),Math.round(this.room.current_room_capacity.distribution_total,3),Math.round(this.room.current_room_capacity.distribution_used,3),Math.round(this.room.current_room_capacity.distribution_available,3),Math.round(this.room.current_room_capacity.climate_total,3),Math.round(this.room.current_room_capacity.climate_used,3),Math.round(this.room.current_room_capacity.climate_available,3),Math.round(this.room.current_room_capacity.surface_total,3),Math.round(this.room.current_room_capacity.surface_used,3),Math.round(this.room.current_room_capacity.surface_available,3)]);var a=[Math.round(this.pop.current_battery_bank_autonomy&&this.pop.current_battery_bank_autonomy.theoretical,3),Math.round(this.totalJunctionsCapacity,3),Math.round(this.totalUsedJunctionsCapacity,3),Math.round(this.totalAvailableJunctionsCapacity,3),Math.round(this.totalGeneratorSetsCapacity,3),Math.round(this.totalGeneratorSetsUsedCapacity,3),Math.round(this.totalAvailableGeneratorSetsCapacity,3),Math.round(this.totalCapacityRoom,3),Math.round(this.usedCapacityRoom,3),Math.round(this.availableCapacityRoom(this.room),3),Math.round(this.totalCapacityBatteries(this.room),3),Math.round(this.usedCapacityBatteries(this.room),3),Math.round(this.availableCapacityBatteries(this.room),3),Math.round(this.totalClimateCapacity,3),Math.round(this.usedClimateCapacity,3),Math.round(this.totalAvailableClimateCapacity,3),Math.round(this.totalDistributionCapacity,3),Math.round(this.usedDistributionCapacity,3),Math.round(this.availableDistributionCapacity,3),Math.round(this.totalSurface,3),Math.round(this.usedSurface,3),Math.round(this.availableSurface,3)],i=e.length?e.reduce(t):0,o=a.reduce(t);return!(this.room.current_room_capacity&&(!this.room.current_room_capacity||i==o))}},methods:{getRoomData:function(){var t=this;axios.get("/api/rooms/".concat(this.$route.params.id)).then((function(e){t.room=e.data.room,t.planeTypeId=t.room.current_room_delegation?t.room.current_room_delegation.plane_delegation_type_id:null,t.getJunctions(),t.getGeneratorSets(),t.getPlanes(),t.getPlaneTypes(),t.getAirConditioners(),t.record?t.recordCapacities():t.record=!0}))},getJunctions:function(){var t=this;axios.get("/api/popJunctions/".concat(this.pop.id)).then((function(e){t.junctions=e.data.junctions,t.canEditJunctions=e.data.can.update})).catch((function(t){console.log("Error al traer los datos de Empalmes: "+t)}))},getGeneratorSets:function(){var t=this;axios.get("/api/generatorSets/".concat(this.pop.id)).then((function(e){t.generatorSets=e.data.generatorSets,t.canEditGeneratorSets=e.data.can.update})).catch((function(t){console.log("Error al traer los datos de Plantas Rectificadoras: "+t)}))},getPlanes:function(){var t=this;axios.get("/api/roomPlanes/".concat(this.room.id,"?plane_delegation_type_id=").concat(this.planeTypeId)).then((function(e){t.planes=e.data.planes,t.canEditPowerRectifiers=e.data.can.update})).catch((function(t){console.log("Error al traer los datos de Empalmes: "+t)}))},getPlaneTypes:function(){var t=this;axios.get("/api/planeTypes").then((function(e){t.planeTypes=e.data.planes,t.canEditPlaneTypes=e.data.can.update}))},getAirConditioners:function(){var t=this;axios.get("/api/airConditioners/".concat(this.pop.id)).then((function(e){t.airConditioners=e.data.airConditioner,t.canEditAirConditioners=e.data.can.update})).catch((function(t){console.log("Error al traer los datos de Empalmes: "+t)}))},recordCapacities:function(){if(this.conditionsToRecord){var t={room_id:this.room.id,battery_autonomy:this.pop.current_battery_bank_autonomy&&this.pop.current_battery_bank_autonomy.theoretical,junction_total:this.totalJunctionsCapacity,junction_used:this.totalUsedJunctionsCapacity,junction_available:this.totalAvailableJunctionsCapacity,generator_set_total:this.totalGeneratorSetsCapacity,generator_set_used:this.totalGeneratorSetsUsedCapacity,generator_set_available:this.totalAvailableGeneratorSetsCapacity,power_rectifier_total:this.totalCapacityRoom,power_rectifier_used:this.usedCapacityRoom,power_rectifier_available:this.availableCapacityRoom(this.room),battery_total:this.totalCapacityBatteries(this.room),battery_used:this.usedCapacityBatteries(this.room),battery_available:this.availableCapacityBatteries(this.room),climate_total:this.totalClimateCapacity,climate_used:this.usedClimateCapacity,climate_available:this.totalAvailableClimateCapacity,distribution_total:this.totalDistributionCapacity,distribution_used:this.usedDistributionCapacity,distribution_available:this.availableDistributionCapacity,surface_total:this.totalSurface,surface_used:this.usedSurface,surface_available:this.availableSurface};axios.post("/api/roomCapacities",t).then((function(t){}))}},powerA:function(t){var e=t.latest_protection?t.latest_protection.regulada_a:0,a=t.latest_measurement?t.latest_measurement.r_a_volt_measure:0;return 2==t.junction_type_id?e*a/1e3:380*e*Math.sqrt(3)/1e3},powerB:function(t){var e=t.latest_protection?t.latest_protection.regulada_b:0;return 2==t.junction_type_id?220*e/1e3:380*e*Math.sqrt(3)/1e3},photovoltaicCapacity:function(t){var e=0;return t.solar_panels.length&&Object.keys(t.solar_panels).forEach((function(a){var i=t.solar_panels[a];e+=i.unit_capacity*i.quantity})),e/1e3},powerUsedA:function(t){var e=t.latest_measurement?t.latest_measurement.r_a_amp_measure:0,a=t.latest_measurement?t.latest_measurement.s_a_amp_measure:0,i=t.latest_measurement?t.latest_measurement.t_a_amp_measure:0,o=t.latest_measurement?t.latest_measurement.r_a_volt_measure:0,r=t.latest_measurement?t.latest_measurement.s_a_volt_measure:0,s=t.latest_measurement?t.latest_measurement.t_a_volt_measure:0;return 2==t.junction_type_id?e*o/1e3:(e*o+a*r+i*s)/1e3},powerUsedB:function(t){var e=t.latest_measurement?t.latest_measurement.r_b_amp_measure:0,a=t.latest_measurement?t.latest_measurement.s_b_amp_measure:0,i=t.latest_measurement?t.latest_measurement.t_b_amp_measure:0,o=t.latest_measurement?t.latest_measurement.r_b_volt_measure:0,r=t.latest_measurement?t.latest_measurement.s_b_volt_measure:0,s=t.latest_measurement?t.latest_measurement.t_b_volt_measure:0;return 2==t.junction_type_id?e*o/1e3:(e*o+a*r+i*s)/1e3},batteryRechargePower:function(t){return this.rechargeCurrent(t)*t.float_tension/1e3},rechargeCurrent:function(t){var e=0;return Object.keys(t.battery_banks).forEach((function(a){e+=t.battery_banks[a].capacity})),t.recharge_factor*e},realPlaneCapacity:function(t){var e=t.current_redundant_modules,a=e?e.capacity*e.quantity:0;return this.installedCapacity(t)-a},installedCapacity:function(t){var e=0;return Object.keys(t.power_rectifiers).forEach((function(a){var i=t.power_rectifiers[a];Object.keys(i.power_rectifier_modules).forEach((function(t){e+=i.power_rectifier_modules[t].capacity}))})),e},totalPower:function(t){return this.chargeRealPower(t)+this.batteryRechargePower(t)},availableCapacityRoom:function(t){var e=this,a=1e7,i=1e7,o=1e7;return Object.keys(this.planes).forEach((function(r){var s=e.planes[r];if(t.current_room_delegation)switch(t.current_room_delegation.plane_delegation_type_id){case 1:case 2:case 3:case 4:case 8:case 9:case 10:case 11:case 12:case 13:a=e.availablePlaneCapacity(s);break;case 5:case 6:case 20:case 21:case 22:a>e.availablePlaneCapacity(s)&&(a=e.availablePlaneCapacity(s));break;case 7:i>e.availablePlaneCapacity(s)&&(1==s.plane_type_id||2==s.plane_type_id)&&(i=e.availablePlaneCapacity(s)),o>e.availablePlaneCapacity(s)&&(3==s.plane_type_id||4==s.plane_type_id)&&(o=e.availablePlaneCapacity(s)),a=i+o}})),a=a<1e7?a:0,this.availablePRCapacity=a,a},availablePlaneCapacity:function(t){return this.realPlaneCapacity(t)-this.totalPower(t)},totalCapacityBatteries:function(t){var e=0;return t.planes&&Object.keys(t.planes).forEach((function(a){var i=t.planes[a];Object.keys(i.battery_banks).forEach((function(t){e+=i.battery_banks[t].capacity}))})),48*e/1e3/this.popAutonomy},usedCapacityBatteries:function(t){var e=this,a=0;return t.planes&&Object.keys(t.planes).forEach((function(i){var o=t.planes[i];a+=e.chargeRealPower(o)})),a},chargeRealPower:function(t){return t.float_tension*t.current/1e3},availableCapacityBatteries:function(t){var e=this,a=1e7,i=1e7,o=1e7;if(t.planes&&t.current_room_delegation)switch(Object.keys(t.planes).forEach((function(r){var s=t.planes[r];switch(t.current_room_delegation.plane_delegation_type_id){case 1:case 2:case 3:case 4:case 8:case 9:case 10:case 11:case 12:case 13:a=e.availableBatteryCapacityPlane(s);break;case 5:case 6:case 20:case 21:case 22:a>e.availableBatteryCapacityPlane(s)&&(a=e.availableBatteryCapacityPlane(s));break;case 7:i>e.availableBatteryCapacityPlane(s)&&(1==s.plane_type_id||2==s.plane_type_id)&&(i=e.availableBatteryCapacityPlane(s)),o>e.availableBatteryCapacityPlane(s)&&(3==s.plane_type_id||4==s.plane_type_id)&&(o=e.availableBatteryCapacityPlane(s)),a=i+o}})),t.current_room_delegation.plane_delegation_type_id){case 1:case 2:case 3:case 4:case 8:case 9:case 10:case 11:case 12:case 13:a=a;break;case 5:case 6:case 7:case 20:case 21:case 22:a*=2}var r=a<1e7?a:0;return this.availableBatteryCapacity=r,r},availableBatteryCapacityPlane:function(t){return this.batteryTotalCapacityPlane(t)-this.chargeRealPower(t)},batteryTotalCapacityPlane:function(t){var e=0;return Object.keys(t.battery_banks).forEach((function(a){e+=t.battery_banks[a].capacity})),48*e/1e3/this.popAutonomy},hasPlanes:function(t){var e=this,a=!1;return this.planes&&Object.keys(this.planes).forEach((function(i){var o=e.planes[i];Object.keys(o.rooms).forEach((function(e){a=a||o.rooms[e].id==t.id}))})),a},powerRectifiersInRoom:function(t){var e=0;return t.planes&&Object.keys(t.planes).forEach((function(a){var i=t.planes[a];e+=i.power_rectifiers.length})),e},batteryBanksInRoom:function(t){var e=0;return t.planes&&Object.keys(t.planes).forEach((function(a){var i=t.planes[a];e+=i.battery_banks.length})),e},hasAirConditioners:function(t){var e=this,a=!1;return this.airConditioners&&Object.keys(this.airConditioners).forEach((function(i){a=a||e.airConditioners[i].room_id==t.id})),a},roomName:function(t){var e=this,a="";return this.pop&&Object.keys(this.pop.rooms).forEach((function(i){a=e.pop.rooms[i].id==t?e.pop.rooms[i].name:a})),a}},beforeDestroy:function(){this.$eventBus.$off("room-data"),this.$eventBus.$off("room-distribution"),this.$eventBus.$off("room-surface"),this.$eventBus.$off("room-security"),this.$eventBus.$off("change-room"),this.$eventBus.$off("new-power-rectifier"),this.$eventBus.$off("new-junction"),this.$eventBus.$off("power-rectifier-updated"),this.$eventBus.$off("new-plane-updated"),this.$eventBus.$off("new-battery-bank"),this.$eventBus.$off("new-generator-set"),this.$eventBus.$off("new-room"),this.$eventBus.$off("new-solar-panel"),this.$eventBus.$off("reload-data"),this.$eventBus.$off("battery-bank-deleted"),this.$eventBus.$off("generator-set-deleted")}},c=a(0),l=Object(c.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("header",{staticClass:"modal-card-head has-background-white has-text-centered"},[a("div",{staticClass:"columns modal-card-title is-vcentered"},[a("div",{staticClass:"column is-2"},[t.previewRoom.id?a("router-link",{staticClass:"button is-default has-text-link",staticStyle:{height:"auto"},attrs:{to:"/capacity/"+t.previewRoom.id,type:"button"},nativeOn:{click:function(e){t.record=!1,t.getRoomData()}}},[a("div",{staticClass:"columns is-vcentered"},[a("div",{staticClass:"column",staticStyle:{"padding-left":"8px","padding-right":"5px"}},[t._v("\n                             "),a("br"),a("font-awesome-icon",{attrs:{icon:["fas","sort-up"],rotation:"270"}}),a("br"),t._v(" \n                        ")],1),t._v(" "),a("div",{staticClass:"column",staticStyle:{"padding-left":"5px","padding-right":"8px"}},[a("div",{staticClass:"has-text-weight-semibold is-size-6"},[t._v(t._s(t.previewRoom.name))])])])]):t._e()],1),t._v(" "),a("div",{staticClass:"column"},[a("div",{staticClass:"has-text-weight-semibold"},[t._v(t._s(t.pop?t.pop.nombre:"")+" - "+t._s(t.room.name)+": "+t._s(t.room.old_name))]),t._v(" "),a("div",{staticClass:"has-text-centered",staticStyle:{"padding-top":"16px"}},[t.canEditPowerRectifiers?a("b-button",{attrs:{size:"is-small"},on:{click:function(e){t.isNewRoomModalActive=!0}}},[t._v("Agregar nueva sala al POP")]):t._e()],1)]),t._v(" "),a("div",{staticClass:"column is-2"},[t.nextRoom.id?a("router-link",{staticClass:"button has-text-link is-default",staticStyle:{height:"auto"},attrs:{to:"/capacity/"+t.nextRoom.id,type:"button"},nativeOn:{click:function(e){t.record=!1,t.getRoomData()}}},[a("div",{staticClass:"columns is-vcentered"},[a("div",{staticClass:"column",staticStyle:{"padding-left":"8px","padding-right":"5px"}},[a("div",{staticClass:"has-text-weight-semibold is-size-6"},[t._v(t._s(t.nextRoom.name))])]),t._v(" "),a("div",{staticClass:"column",staticStyle:{"padding-left":"5px","padding-right":"8px"}},[t._v("\n                             "),a("br"),a("font-awesome-icon",{attrs:{icon:["fas","sort-up"],rotation:"90"}}),a("br"),t._v(" \n                        ")],1)])]):t._e()],1)])]),t._v(" "),a("section",{staticClass:"section is-paddingless"},[a("div",{staticClass:"has-background-white",staticStyle:{padding:"12px"}},[a("div",{staticClass:"level"},t._l(t.capacityData,(function(e){return a("div",{staticClass:"level-item",staticStyle:{position:"relative"}},[a("div",{},[a("div",{staticClass:"is-size-6"},[a("div",{staticClass:"has-text-weight-semibold is-size-6",staticStyle:{"padding-bottom":"4px"}},[t._v(t._s(e.title.toUpperCase()))]),t._v(" "),a("div",{staticClass:"is-size-6"},[t._v("Total: "+t._s(t._f("numeral")(e.total,"0,0.0"))+" "),a("span",{staticClass:"is-size-7"},[t._v(t._s(e.unit))])]),t._v(" "),a("div",{staticClass:"is-size-6"},[t._v("Utilizada: "+t._s(t._f("numeral")(e.used,"0,0.0"))+" "),a("span",{staticClass:"is-size-7"},[t._v(t._s(e.unit))])]),t._v(" "),a("div",{staticClass:"is-size-6"},[t._v("Disponible: "+t._s(t._f("numeral")(e.available,"0,0.0"))+" "),a("span",{staticClass:"is-size-7"},[t._v(t._s(e.unit))])])]),t._v(" "),a("div",{staticClass:"block",staticStyle:{"padding-top":"8px"}},[a("b-progress",{attrs:{value:100*e.available/e.total,"show-value":"",format:"percent",size:"is-small",type:e.available/e.total<=e.thresholds.critical?"is-danger":e.available/e.total<=e.thresholds.warning?"is-warning":"is-success"}})],1)])])})),0)])]),t._v(" "),a("section",{staticClass:"modal-card-body hero is-light",staticStyle:{"padding-top":"0"}},[a("div",{staticClass:"columns section"},[a("div",{staticClass:"column is-1"},[a("div",{staticClass:"columns is-multiline"},t._l(t.tabs,(function(e){return a("div",{key:e.component,staticClass:"column is-12",class:t.currentTab===e.component&&("eco"==t.currentTab?"has-background-eco":"is-bold is-link"),on:{click:function(a){t.currentTab=e.component}}},[a("div",{staticClass:"tile is-child box has-text-centered",class:t.currentTab===e.component?"is-bold is-link":""},[a("font-awesome-icon",{class:t.currentTab===e.component?"has-text-white":"has-text-grey",attrs:{icon:[e.icon_type,e.icon],size:"2x"}}),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("div",{staticClass:"is-size-7 has-text-weight-normal"},[t._v("\n                                    "+t._s(e.title)+"\n                                ")])])],1)])})),0)]),t._v(" "),a("div",{staticClass:"column",staticStyle:{"padding-left":"48px"}},[a(t.currentTabComponent,{tag:"component",attrs:{user:t.user,room:t.room,pop:t.room.pop,junctions:t.junctions,generatorSets:t.generatorSets,planes:t.planes,planeTypes:t.planeTypes,airConditioners:t.airConditioners,canEditJunctions:t.canEditJunctions,canEditGeneratorSets:t.canEditGeneratorSets,canEditPowerRectifiers:t.canEditPowerRectifiers,canEditAirConditioners:t.canEditAirConditioners,canEditSurface:t.canEditSurface,canEditDistribution:t.canEditDistribution,canEditPlaneTypes:t.canEditPlaneTypes,totalJunctionsCapacity:t.totalJunctionsCapacity,totalUsedJunctionsCapacity:t.totalUsedJunctionsCapacity,totalAvailableJunctionsCapacity:t.totalAvailableJunctionsCapacity,totalGeneratorSetsCapacity:t.totalGeneratorSetsCapacity,totalGeneratorSetsUsedCapacity:t.totalGeneratorSetsUsedCapacity,totalAvailableGeneratorSetsCapacity:t.totalAvailableGeneratorSetsCapacity,totalGeneratorSetsCapacityA:t.totalGeneratorSetsCapacityA,totalGeneratorSetsCapacityB:t.totalGeneratorSetsCapacityB,usedGeneratorSetsCapacityA:t.usedGeneratorSetsCapacityA,usedGeneratorSetsCapacityB:t.usedGeneratorSetsCapacityB,availableGeneratorSetsCapacityA:t.availableGeneratorSetsCapacityA,availableGeneratorSetsCapacityB:t.availableGeneratorSetsCapacityB,totalSurface:t.totalSurface,usedSurface:t.usedSurface,availableSurface:t.availableSurface,totalDistributionCapacity:t.totalDistributionCapacity,usedDistributionCapacity:t.usedDistributionCapacity,availableDistributionCapacity:t.availableDistributionCapacity}})],1)])]),t._v(" "),a("b-modal",{attrs:{active:t.isNewRoomModalActive,"has-modal-card":"","trap-focus":"","aria-role":"dialog","aria-modal":""},on:{"update:active":function(e){t.isNewRoomModalActive=e}}},[a("modal-new-room",{attrs:{pop:t.pop,user:t.user}})],1)],1)}),[],!1,null,null,null);e.default=l.exports}}]);