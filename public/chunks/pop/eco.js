(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{332:function(t,e,s){"use strict";s.r(e);var a=s(3),i=s(1),o=s(4);a.d.add(o.b,i.Bb,i.hb,i.R,i.P,i.L,i.M,i.J,i.c,o.g);var n={components:{},props:["user","pop","bodyBackground","boxBackground","primaryText","secondaryText"],data:function(){return{rcas:[],dropFiles:[],temporaryStorages:[],temporaryStoragesData:[],isLoading:!1}},computed:{isTempStorage:function(){var t=this,e=!1;return this.temporaryStorages.environmentalData&&this.temporaryStorages.environmentalData.pop&&this.temporaryStorages.environmentalData.forEach((function(s){0==e&&(e=s.pop.id==t.pop.id),t.temporaryStoragesData.push(s)})),e},hasRcas:function(){return!(!this.rcas.environmentalData||!this.rcas.environmentalData.length)}},mounted:function(){this.getRCAs(),this.getTempStorage()},methods:{getRCAs:function(){var t=this;axios.get("/api/rcas/".concat(this.pop.id)).then((function(e){console.log(e.data),t.rcas=e.data}))},getTempStorage:function(){var t=this;axios.get("/api/ecoStorage/".concat(this.pop.id)).then((function(e){t.temporaryStorages=e.data}))},submit:function(){var t=this;this.dropFiles.forEach((function(e){return t.submitForm(e)}))},submitForm:function(t){var e=this,s={headers:{"content-type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},params:{pop_id:this.pop.id}},a=new FormData;a.append("file",t);try{axios.post("/api/rcas",a,s).then((function(t){e.getRCAs()}))}catch(t){console.log(t)}},faFile:function(t){return{icon:"pdf"==t?"file-pdf":"jpg"==t||"png"==t||"jpeg"==t?"file-image":"xls"==t||"xlsx"==t?"file-excel":"file",type:"pdf"==t?"has-text-info":"jpg"==t||"png"==t||"jpeg"==t?"has-text-warning":"xls"==t||"xlsx"==t?"has-text-success":"has-text-primary"}},readFile:function(t){var e=this;this.isLoading=!0;var s={route:t.route,mime:t.mime,basename:t.basename,dirname:t.dirname};axios.get("/api/viewFile",{params:s,responseType:"arraybuffer"}).then((function(s){var a=new Blob([s.data],{type:t.mime}),i=URL.createObjectURL(a);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(newBlob);else{var o=document.createElement("a");o.href=i,o.open=t.basename,o.click(),setTimeout((function(){URL.revokeObjectURL(i)}),100),e.isLoading=!1,e.$buefy.toast.open({message:"El archivo se ha descargado exitosamente.",type:"is-success",duration:5e3})}})).catch((function(t){console.log(t),e.isLoading=!1,e.$buefy.toast.open({message:"Ha ocurrido un error. Favor contactar al administrador",type:"is-danger",duration:5e3})}))}}},r=s(0),c=Object(r.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{attrs:{id:"eco"}},[t._m(0),t._v(" "),s("div",{staticClass:"tile is-ancestor"},[s("div",{staticClass:"tile is-vertical"},[s("div",{staticClass:"tile is-parent"},[s("div",{staticClass:"box tile is-child"},[s("div",{staticClass:"field"},[s("div",{staticClass:"title is-size-4 has-text-weight-semibold has-text-centered"},[t._v("Zona protegida")]),t._v(" "),t.pop.protected_zones.length?s("div",[t._m(1),t._v(" "),t._l(t.pop.protected_zones,(function(e){return s("div",{staticClass:"title is-size-5 has-text-weight-semibold has-text-centered",staticStyle:{"padding-top":"12px"}},[t._v("Zona "+t._s(e.cod_zone)+"\n                                "),s("div",{staticClass:"is-size-5 has-text-weight-light"},[t._v(t._s(e.name))])])}))],2):t._e(),t._v(" "),t.pop.protected_zones.length?t._e():s("div",{staticClass:"is-size-6 has-text-weight-light has-text-centered"},[t._v("Este PoP "),s("span",{staticClass:"has-text-weight-semibold has-text-positive"},[t._v("NO")]),t._v(" se encuentra dentro de una zona protegida.")])])])]),t._v(" "),s("div",{staticClass:"tile is-parent"},[s("div",{staticClass:"box tile is-child"},[s("div",{staticClass:"field"},[s("div",{staticClass:"title is-size-4 has-text-weight-semibold has-text-centered"},[t._v("Zona Acopio Temporal")]),t._v(" "),t.isTempStorage?s("div",{staticClass:"is-size-6 has-text-weight-light has-text-centered"},[t._v("Este PoP es "),s("span",{staticClass:"has-text-weight-semibold has-text-smart"},[t._v("Zona de Acopio Temporal")]),t._v(".")]):t._e(),t._v(" "),!t.isTempStorage&t.temporaryStoragesData.length?s("div",[s("div",{staticClass:"is-size-6 has-text-weight-light has-text-centered"},[t._v("Este PoP tiene asociada las siguientes zonas de acopio temporal:")]),t._v(" "),t._l(t.temporaryStoragesData,(function(e){return s("div",{staticClass:"title is-size-5 has-text-weight-semibold has-text-centered",staticStyle:{"padding-top":"12px"}},[s("a",{attrs:{href:"/pop/"+e.pop.id+"#eco",target:"_blank"}},[t._v(t._s(e.pop.nombre))]),t._v(" "),s("div",{staticClass:"is-size-5 has-text-weight-light"},[t._v(t._s(e.pop.direccion))])])}))],2):t._e(),t._v(" "),t.temporaryStoragesData.length?t._e():s("div",{staticClass:"is-size-6 has-text-weight-light has-text-centered"},[t._v("Este PoP "),s("span",{staticClass:"has-text-weight-semibold has-text-positive"},[t._v("NO")]),t._v(" tiene asignada Zona de Acopio Temporal.")])])])])]),t._v(" "),s("div",{staticClass:"tile is-parent"},[s("div",{staticClass:"box tile is-child"},[s("div",{staticClass:"field"},[s("div",{staticClass:"title is-size-4 has-text-weight-semibold has-text-centered"},[t._v("Resolucion de Calificación Ambiental")]),t._v(" "),t.hasRcas?s("div",[s("b-table",{attrs:{data:t.rcas.environmentalData},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{field:"basename",label:"Nombre archivo"}},[s("a",{staticClass:"has-text-dark",on:{click:function(s){return t.readFile(e.row)}}},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-1"},[s("font-awesome-icon",{class:t.faFile(e.row.extension).type,attrs:{icon:["fas",t.faFile(e.row.extension).icon]}})],1),t._v(" "),s("div",{staticClass:"column"},[s("div",{staticClass:"is-size-6"},[t._v(t._s(e.row.basename))])])])])])]}}],null,!1,1317482038)},[t._v(" "),s("template",{slot:"empty"},[s("section",{staticClass:"section"},[s("div",{staticClass:"content has-text-grey has-text-centered"},[s("p",[s("b-icon",{attrs:{icon:"emoticon-sad",size:"is-large"}})],1),t._v(" "),s("p",[t._v("Nothing here.")])])])])],2)],1):t._e(),t._v(" "),t.hasRcas?t._e():s("div",{staticClass:"is-size-6 has-text-weight-light has-text-centered"},[t._v("Este PoP "),s("span",{staticClass:"has-text-weight-semibold has-text-positive"},[t._v("NO")]),t._v(" tiene Resolucion de Calificación Ambiental (R.C.A.).")])]),t._v(" "),t.rcas.can&&t.rcas.can.upload?s("b-field",[s("b-upload",{attrs:{multiple:"","drag-drop":""},on:{input:t.submit},model:{value:t.dropFiles,callback:function(e){t.dropFiles=e},expression:"dropFiles"}},[s("section",{staticClass:"section"},[s("div",{staticClass:"content has-text-centered"},[s("p",[s("b-icon",{attrs:{icon:"upload",pack:"fas",size:"is-large"}})],1),t._v(" "),s("p",[t._v("Drop your files here or click to upload")])])])])],1):t._e()],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"columns"},[e("div",{staticClass:"column has-text-weight-semibold has-text-dark is-size-3 has-text-left"},[this._v("Gestión Ambiental")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"is-size-6 has-text-weight-light has-text-centered"},[this._v("Este PoP "),e("span",{staticClass:"has-text-weight-semibold has-text-eco"},[this._v("SI")]),this._v(" se encuentra dentro de una zona protegida")])}],!1,null,null,null);e.default=c.exports}}]);